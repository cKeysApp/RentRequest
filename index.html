<!DOCTYPE html>
<html>
<head>
  <title>Find Rental | Tenant Request</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f7fa;
      margin: 0;
      padding: 20px;
    }

    .container {
      max-width: 520px;
      margin: auto;
      background: #ffffff;
      padding: 25px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    h2 {
      text-align: center;
      margin-bottom: 5px;
    }

    p {
      text-align: center;
      color: #666;
      margin-bottom: 20px;
    }

    input, select {
      width: 100%;
      padding: 12px;
      margin-top: 6px;
      margin-bottom: 14px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 14px;
      box-sizing: border-box;
    }

    label {
      font-size: 14px;
      font-weight: bold;
    }

    button {
      width: 100%;
      padding: 14px;
      background: #28a745;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
    }

    button:hover {
      background: #218838;
    }

    .success {
      text-align: center;
      color: green;
      margin-top: 15px;
      display: none;
    }

    .budget-wrap { margin-bottom: 14px; }

    .budget-values {
      display: flex;
      justify-content: center;
      margin: 8px 0 10px;
      font-weight: bold;
      color: #222;
    }
    
    .range-group {
      position: relative;
      height: 34px;
    }
    
    .range-group input[type="range"]{
      position: absolute;
      left: 0;
      top: 0;
      margin: 0;
      width: 100%;
      height: 34px;
      background: transparent;
      pointer-events: none; /* important: we enable per-thumb below */
    }
    
    /* allow interaction */
    .range-group input[type="range"]::-webkit-slider-thumb{
      pointer-events: auto;
    }
    .range-group input[type="range"]::-moz-range-thumb{
      pointer-events: auto;
    }

  </style>
</head>
<body>

<div class="container">

<h2>Looking for a Place to Rent?</h2>
<p>Submit your request and we will match you with available landlords.</p>

<form id="requestForm">

<label>Full Name</label>
<input name="name" required>

<label>Email</label>
<input name="email">

<label>Phone / WhatsApp</label>
<input name="phone" required>

<label>Property Type</label>
<select name="propertyType" required>
  <option value="">Select Property Type</option>
  <option>Room</option>
  <option>Apartment</option>
  <option>House</option>
</select>

<label>State</label>
<select id="state" name="state" required>
  <option value="">Select State</option>
  <option>Johor</option>
  <option>Kedah</option>
  <option>Kelantan</option>
  <option>Melaka</option>
  <option>Negeri Sembilan</option>
  <option>Pahang</option>
  <option>Penang</option>
  <option>Perak</option>
  <option>Perlis</option>
  <option>Sabah</option>
  <option>Sarawak</option>
  <option>Selangor</option>

</select>

<label>City / Town</label>
<select id="city" name="city" required>
  <option value="">Select City</option>
</select>

<label>Budget (RM)</label>

<div class="budget-wrap">
  <div class="budget-values">
    <span id="budgetText">RM 500 – RM 1500</span>
  </div>

  <div class="range-group">
    <input id="minBudget" type="range" min="0" max="5000" step="50" value="500">
    <input id="maxBudget" type="range" min="0" max="5000" step="50" value="1500">
  </div>

  <!-- This keeps your backend exactly the same -->
  <input type="hidden" name="budget" id="budgetHidden" value="500 - 1500">
</div>

<label>Move-in Date</label>
<input name="moveInDate" type="date">

<label>Duration (months)</label>
<input name="duration">

<label>Occupation</label>
<input name="occupation">

<label>Number of People</label>
<input name="people">

<label>Extra Needs</label>
<input name="needs" placeholder="Washing machine, parking, furnished, etc">

<button type="submit">Submit Request</button>

</form>

<div class="success" id="successMsg">
Request submitted successfully!
</div>

</div>

<script>
// City options by state
const cityOptions = {
  "Johor": ["Kluang", "Kulai", "Tangkak", "Masai", "Parit Jawa", "Batu Pahat", "Ulu Tiram", "Mersing", "Johor Baharu", "Kota Tinggi"],
  "Kedah": ["Alor Setar", "Langkawi", "Sungai Petan", "Baling", "Changloon", "Kodiang", "Jitra", "Kulim", "Pendang", "Serdang"],
  "Kelantan": ["Kota Bharu", "Dabong", "Jelawat", "Ketereh", "Kuala Krai", "Kubang Kerian", "Machang", "Pasir Mas", "Pengkalan Chepa", "Pengkalan Kubor", "Pengkalan Pasir", "Perupok", "Wakaf Bharu", "Wakaf Che Yeh"], 
  "Melaka": ["Ayer Keroh", "Alor Gajah", "Asahan", "Ayer Paabas", "Batu Berendam", "Bemban", "Jasin", "Klebang", "Lendu, Alor Gajah", "Lubuk China", "Machap Baru", "Paya Rumput", "Pokok Mangga", "Simpang Ampat", "Telok Gong", "Telok Mas"],
  "Negeri Sembilan": ["Air Kuning Selatan", "Ampang Tinggi", "Bahau", "Bandar Baru Nilai", "Bandar Seri Jempol", "Batang Benar", "Batu Kikir", "Gemas", "Kota", "Kuala Pilah", "Kuala Sawah", "Lukut", "Mambau", "Nilai", "Pajam", "Pasir Panjang", "Pengkalan Kempas", "Port Dickson", "Rembau", "Rompin", "Senawang", "Seremban 2", "Seremban 3", "Seri Menanti", "Serting", "Sikamat", "Siliau", "Simpang Durian", "Simpang Pertang", "Sungai Gadut", "Sungai Muntoh", "Tampin", "Tanjung Ipoh", "Teluk Kemang", "Tiroi"],
  "Pahang": ["Bandar Bera", "Bandar Muadzam Shah", "Bandar Tun Razak", "Batu Hitam", "Batu Talam", "Belimbing", "Benta", "Bentong", "Beserah", "Blue Valley", "Brinchang", "Bukit Ibam", "Bukit Tinggi", "Chendor", "Chenor", "Cherating", "FELDA Sebertak", "Fraser's Hill", "Gambang", "Gebeng", "Genting Highlands", "Genting Sempah", "Gohtong Jaya", "Jerantut", "Karak", "Kemayan", "Kerdau", "Ketari", "Kota Shahbandar", "Kuala Lipis", "Kuala Pahang", "Kuala Rompin", "Kuala Semantan", "Kuala Simpang", "Kuala Tembeling", "Lanchang", "Lubuk Paku", "Lurah Bilut", "Maran", "Mengkarak", "Mentakab", "Merapoh", "Nenasi", "Paloh Hinai", "Pekan", "Penor", "Raub", "Ringlet", "Sungai Lembing", "Sungai Ruan", "Tanah Rata", "Tanjung Lumpur", "Teluk Cempedak", "Temerloh", "Teriang", "Tringkap"],
  "Penang": ["Bukit Mertajam", "Balik Pulau", "Batu Kawan", "Bayan Lepas", "Bukit Tambun", "Butterworth", "Gertak Sanggul", "Butterworth", "Kepala Batas", "Mak Mandin", "Nibong Tebal", "Penanti", "Perai", "Permatang Pauh", "Pinang Tunggal", "Simpang Ampat", "Tasek Gelugor", "Teluk Air Tawar", "Teluk Bahang", "Teluk Kumbar", "Val d'Or"],
  "Perak": ["Sungai Siput", "Ipoh", "Taiping", "Gopeng", "Gerik", "Chemor", "Lumut", "Simpang Ampat Semanggol", "Kuala Kangsar", "Tanjong Malim"],
  "Perlis": ["Kangar", "Padang Besar", "Kaki Bukit", "Kuala Perlis"],
  "Sabah": ["Ranau", "Kota Kinabalu", "Sandakan", "Tamparuli", "Tuaran", "Penampang", "Lahad Datu", "Semporna", "Tawau", "Kota Belud"],
  "Sarawak": ["Miri", "Kuching", "Niah", "Bau", "Nanga Medamit", "Bintulu", "Kota Samarahan", "Sibu", "Limbang", "Lundu"],
  "Selangor": ["Petaling Jaya", "Shah Alam", "Ampang", "Rawang", "Gombak", "Semenyih", "Hulu Langat", "Ampang Jaya", "Seri Kembangan", "Kuala Kubu Bharu"],
};

// Update city dropdown when state changes
document.getElementById("state").addEventListener("change", function() {
  const state = this.value;
  const citySelect = document.getElementById("city");

  citySelect.innerHTML = "<option value=''>Select City</option>";

  if (cityOptions[state]) {
    cityOptions[state].forEach(city => {
      const option = document.createElement("option");
      option.value = city;
      option.textContent = city;
      citySelect.appendChild(option);
    });
  }
});
// Budget slider (min/max)
const minSlider = document.getElementById("minBudget");
const maxSlider = document.getElementById("maxBudget");
const budgetText = document.getElementById("budgetText");
const budgetHidden = document.getElementById("budgetHidden");

function formatRM(n) {
  return "RM " + Number(n).toLocaleString("en-MY");
}

function syncBudget() {
  let minVal = Number(minSlider.value);
  let maxVal = Number(maxSlider.value);

  // prevent crossing
  if (minVal > maxVal) {
    [minVal, maxVal] = [maxVal, minVal];
  }

  budgetText.textContent = `${formatRM(minVal)} – ${formatRM(maxVal)}`;
  budgetHidden.value = `${minVal} - ${maxVal}`;
}

minSlider.addEventListener("input", syncBudget);
maxSlider.addEventListener("input", syncBudget);
syncBudget();

// Submit form to Google Apps Script
document.getElementById("requestForm").addEventListener("submit", function(e) {
  e.preventDefault();

  const form = this;
  const data = Object.fromEntries(new FormData(form).entries());

  fetch("https://script.google.com/macros/s/AKfycbzFCOUoIXtEKeyRZd6jvABcgu-pRT4Ju3AdnyXv0ZjjDOpzC1Wc0ZFGaW533ENNiLpb/exec", {
    method: "POST",
    body: JSON.stringify(data)
  })
  .then(res => res.text())
  .then(() => {
    document.getElementById("successMsg").style.display = "block";
    form.reset();
  })
  .catch(() => {
    alert("Submission failed. Please try again.");
  });
});
</script>

</body>
</html>
