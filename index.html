<!DOCTYPE html>
<html>
<head>
  <title>Find Rental - Submit Your Request</title>
  <style>
    body {
      font-family: Arial;
      max-width: 500px;
      margin: auto;
      padding: 20px;
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin: 5px 0;
    }
    button {
      padding: 12px;
      background: green;
      color: white;
      border: none;
      width: 100%;
      font-size: 16px;
    }
  </style>
</head>
<body>

<h2>Looking for a Place to Rent?</h2>
<p>Submit your request and we will match you with landlords.</p>

<form id="requestForm">

<input name="name" placeholder="Full Name" required>
<input name="email" placeholder="Email">
<input name="phone" placeholder="Phone / WhatsApp" required>

<select name="propertyType">
  <option>Room</option>
  <option>Apartment</option>
  <option>House</option>
</select>

<input id="locationInput" placeholder="Type location (e.g. Setapak, KL)" />
<div id="map" style="height:300px; margin:10px 0;"></div>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCQtbofqSeB6HVesl-ItaVwfVpnDDXevXQ&libraries=places"></script>

<script>
let map, marker, circle;
let selectedLat = "";
let selectedLng = "";
let selectedRadius = 3;

function initMap() {
  map = new google.maps.Map(document.getElementById("map"), {
    center: { lat: 3.1390, lng: 101.6869 }, // KL default
    zoom: 12
  });

  const input = document.getElementById("locationInput");
  const autocomplete = new google.maps.places.Autocomplete(input);

  autocomplete.addListener("place_changed", function () {
    const place = autocomplete.getPlace();
    if (!place.geometry) return;

    selectedLat = place.geometry.location.lat();
    selectedLng = place.geometry.location.lng();

    map.setCenter(place.geometry.location);

    if (marker) marker.setMap(null);
    if (circle) circle.setMap(null);

    marker = new google.maps.Marker({
      position: place.geometry.location,
      map: map,
      draggable: true
    });

    circle = new google.maps.Circle({
      map: map,
      center: place.geometry.location,
      radius: selectedRadius * 1000,
      editable: true,
      draggable: true
    });

    // Update values when moved
    google.maps.event.addListener(circle, 'radius_changed', function() {
      selectedRadius = (circle.getRadius() / 1000).toFixed(1);
    });

    google.maps.event.addListener(circle, 'center_changed', function() {
      selectedLat = circle.getCenter().lat();
      selectedLng = circle.getCenter().lng();
    });
  });
}

window.onload = initMap;
</script>

<input name="budget" placeholder="Budget Range (RM)">
<input name="moveInDate" type="date">
<input name="duration" placeholder="Duration (months)">
<input name="occupation" placeholder="Occupation">
<input name="people" placeholder="Number of people">
<input name="needs" placeholder="Extra needs (washing machine, parking, etc)">

<button type="submit">Submit Request</button>

</form>

<script>
document.getElementById("requestForm").addEventListener("submit", function(e) {
  e.preventDefault();

  const formData = Object.fromEntries(new FormData(this).entries());

  formData.locationText = document.getElementById("locationInput").value;
  formData.lat = selectedLat;
  formData.lng = selectedLng;
  formData.radius = selectedRadius;

  fetch("YOUR_SCRIPT_URL", {
    method: "POST",
    body: JSON.stringify(formData)
  })
  .then(res => res.text())
  .then(msg => {
    alert("Request submitted!");
    this.reset();
  });
});

</script>

</body>
</html>
